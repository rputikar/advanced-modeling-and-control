---
title: "Basics of Process Control and Modeling"
date: 2023-07-08
---

::: {.content-visible when-format="html"}

:::{.grid}
::: {.g-col-5}
[Lecture resources](../../lectures/01-recap/index.qmd){.btn .btn-success .btn-lg role="button"}
:::
:::

:::

## Importance of process analysis and control

Chemical processes greatly influence every aspect of our life. 
All important industrial sector such as food production, water treatment,
healthcare and pharmaceuticals, energy, automotives, and so on rely on chemical
process industry to supply ingradients, raw materials, and enabling
technologies. 
In recent years, significant attention is given to sustainability in the
chemical process industry. New processes and retrofit of existing processes are 
based on responsible resource utilization, minimization of environmental impact,
and considerations to long-term viability and competitiveness.
Chemical processes involve several unit operations, such as
mixing, heat exchange, mass transfer, and reaction.
In a chemical process, required unit operations are performed in a specific
sequence to achieve specific objectives.
In order to ensure optimal operations of the process it is important to have
efficient and effective control over process variables such as temperature,
pressure, flow rate, and composition. 
Optimal operations are crucial for maintaining safety, and achieving desired
product quality. 
Control systems and advanced algorithms are deployed to monitor, regulate, and
optimize the process variables.  

Controlling processes involves influencing their operation to achieve
desired outcomes. This is accomplished through the use of control units, which
regulate and guide processes to maintain steady operation and prevent
deviations from target conditions. It is important to recognize that all
industrial processes are dynamic, meaning their behavior changes over time.
Control engineers must have a deep understanding of process dynamics and
develop suitable mechanisms to influence and manage their behavior effectively.

Control engineering is an integral part of chemical engineering. 
Design engineers must account for dynamic operation and its consequences, while
plant operators must respond to disruptions for smooth operation. Experimental
engineers rely on process control for precise conditions. Without process
control, modern processing facilities cannot operate safely, reliably, and
profitably while meeting quality and environmental standards.

## Process control objectives

Control systems play a crucial role in ensuring safe and
profitable operation of processes involving various streams. 
These control systems continuously monitor process variables such as
temperature, pressure, level, flow, and concentration. 
They take actions, such as adjusting valves, controlling pump
speed, and regulating heaters, to maintain these variables at specified set
point values defined by operators. 
This enables processes to operate efficiently, meeting desired objectives while
prioritizing safety and profitability.

The primary objective of any control system is safety. 
Control systems are designed to ensure the safety of people, protect
the environment, and safeguard equipment. 
By continuously monitoring and
adjusting process variables, these systems can detect and respond to deviations
or disturbances that may pose risks or compromise the integrity of the system.
This proactive approach to safety helps prevent accidents, minimize
environmental impact, and preserve the longevity of equipment.

When faced with competing objectives, the specific tradeoff considerations vary
depending on the industry, scale, and potential consequences involved.
For example, 
In extreme scenarios such as a nuclear plant, the control system may shut down
the operations to prevent potential deadly radiation leaks. 
On the other hand, in power or chemical industry,
there is a tradeoff between controlling emissions and equipment safety. 
In order to keep the operations running optimally, the control system may
deviate from the emission norms occasionally. 
Stricter emission control measures, may place additional stress on equipment
and require diligent maintenance to ensure safe operation. 
Balancing emissions control with equipment safety becomes crucial to mitigate
environmental harm while ensuring the integrity and reliability of the
industrial process.

In addition to safety, automatic control also enhances efficiency and
performance. 
By maintaining process variables at optimal set points, these
systems enable processes to operate at peak efficiency, reduce energy
consumption, improve product quality, and increase overall productivity. 
This not only maximizes output and profitability but also contributes to
sustainability efforts by minimizing resource wastage and emissions.

After ensuring the people, environment, and equipment safety objectives are met, 
the control objectives can focus on the profit. 

Plant-level control objectives motivated by profit include:

- meeting final product specifications
- minimizing waste production
- minimizing environmental impact
- minimizing energy use
- maximizing overall production rate

::: {#fig-process-variability layout="[45,-10,45]"}
![Poor control requires set point far from
constraint](../../../assets/images/01-recap-fig1-pv_poorly_controlled.png){#fig-poor-control}

![Good control permits set point near
constraint](../../../assets/images/01-recap-fig2-pv_tightly_controlled.png){#fig-good-control}

Process control plays a vital role in reducing variability
:::

The optimization of process operating conditions aims to maximize economic
objectives, such as annual profit. Effective plant management involves
determining desirable operating targets and implementing an efficient automatic
control strategy to maintain these targets within acceptable limits. Chemical
engineers are well-suited for setting control objectives as they possess a
clear understanding of how the plant operates.

To identify the most desirable operating conditions, the feasible region of
operation is defined based on the physical limits of decision variables. Plant
economics are then evaluated by assessing increasing profit contours. While the
optimum operating point often lies at a corner of the feasible region,
practical considerations and plant disturbances necessitate operating at a
slight distance from this point to ensure feasible operation (@fig-optimal-plant-operations).

The control strategy focuses on minimizing variations around the operating
target and reducing the acceptable operating limits. Advanced control systems
offer the potential for operating even closer to the optimal target, resulting
in increased profitability. This improvement, quantified by a shift towards a
more profitable regime, demonstrates the financial benefits of the control
system.

![Optimal plant operations](../../../assets/images/01-recap-fig3-optimal-plant-operations.png){#fig-optimal-plant-operations}

## Hirarchy of process control activities

The hierarchy of process control activities is shown in @fig-control-activity-hirarchy. 

### Measurement and Actuation (Level 1)

  Instrumentation, which includes sensors and transmitters, is used to measure
  variables in a process. Actuation equipment, such as control valves, is
  employed to carry out the control actions determined by these measurements.
  In essence, measurement and actuation functions are fundamental components of
  any control system, as they enable the system to gather data about the
  process and respond accordingly to maintain optimal conditions or meet set
  parameters.

### Safety and environmental/ equipment protection (Level 2)

  Level 2 functions are essential in ensuring both the safety of the process
  and its compliance with environmental regulations. As discussed in Chapter
  10, the approach to process safety involves the establishment of multiple
  layers of protection, consisting of various equipment and human actions. 

  A layer of this protection includes process control functions, like managing
  alarms during unusual situations and utilizing safety instrumented systems
  for emergency shutdowns. The safety gear, which encompasses sensors and
  control valves, functions independently of the standard instrumentation used
  for regulatory control in Level 3a.

  Methods for validating sensor functionality can be utilized to verify that
  these sensors are operating correctly.

### Regulatory control (Level 3a)

  The successful operation of a process requires that critical process
  variables, such as flow rates, temperatures, pressures, and compositions, are
  managed at or near their specified set points. This activity, known as
  regulatory control, is achieved by applying standard feedback and feedforward
  control techniques. 

  However, if these conventional control methods are not sufficient, a range of
  advanced control techniques is at our disposal. In recent times, there's been
  an increasing interest in the performance monitoring of control systems.

### Multivariable and constraint control (Level 3b)

  Many challenging process control issues have two key characteristics: they
  involve significant interactions among important process variables and they
  have inequality constraints for manipulated and controlled variables. These
  constraints, which include upper and lower limits, could be based on the
  capabilities of equipment or operational objectives for the process.

  Operating a process near a constraint limit is a significant goal for
  advanced process control. In many industrial operations, optimal conditions
  are often at the constraint limit. However, the set point should not be the
  constraint value to prevent surpassing the limit due to disturbances.
  Therefore, it's critical to set a conservative set point depending on the
  control system's capacity to minimize disturbances.

  Standard process control techniques might not be sufficient for managing
  complex control problems that involve severe process interactions and
  inequality constraints. In such cases, advanced control methods should be
  considered, including multivariable control and constraint control.
  Specifically, the model predictive control (MPC) strategy is designed to
  handle process interactions and inequality constraints.

### Real time optimization (Level 4)

  The optimal operating conditions for a plant are established during the
  process design phase. However, during the operation of the plant, these
  conditions can frequently change due to variations in equipment availability,
  process disturbances, and economic circumstances such as changes in raw
  material costs and product prices. As a result, it can be highly beneficial
  to frequently recalculate the optimal operating conditions. This activity,
  known as real-time optimization (RTO), involves implementing new optimal
  conditions as set points for controlled variables.

  The RTO calculations are based on a steady-state model of the plant and
  economic data like costs and product values. The usual objective of the
  optimization is to either minimize operating costs or maximize operating
  profits. RTO calculations can be conducted for an individual process unit or
  for the whole plant.

  Level 4 activities also incorporate data analysis to confirm the accuracy of
  the process model used in the RTO calculations under current conditions.
  Therefore, data reconciliation techniques can be utilized to ensure that
  steady-state mass and energy balances are met. Additionally, the process
  model can be updated using parameter estimation techniques and recent plant
  data.

### Planning and scheduling (Level 5) 

  The highest tier of the process control hierarchy is focused on strategizing
  and orchestrating operations for the entire plant. For continuous processes,
  the production rates of all products and intermediates need to be planned and
  harmonized. This involves considering equipment limitations, storage
  capacity, sales forecasts, and the operations of other plants, which can
  sometimes be globally distributed.

  For the intermittent operation of batch and semi-batch processes, production
  control transforms into a batch scheduling issue, guided by similar
  considerations. Hence, planning and scheduling tasks present challenging
  optimization problems that are founded on both engineering factors and
  business forecasts.

![Hirarchy of process control activities](../../../assets/images/01-recap-time-scales-of-process-control-activities.png){#fig-control-activity-hirarchy}

## Overview of control system design

The major steps involved in designing and installing a control system using the
model-based approach are shown in the flow chart of @fig-major-steps. The first
step, formulation of the control objectives, is a critical decision. The
formulation is based on the operating objectives for the plants and the process
constraints. For example, in the distillation column control problem, the
objective might be to regulate a key component in the distillate stream, the
bottoms stream, or key components in both streams. An alternative would be to
minimize energy consumption (e.g., reboiler heat duty) while meeting product
quality specifications on one or both product streams. The inequality
constraints should include upper and lower limits on manipulated variables,
conditions that lead to flooding or weeping in the column, and product impurity
levels. After the control objectives have been formulated, a dynamic model of
the process is developed. The dynamic model can have a theoretical basis, for
example, physical and chemical principles such as conservation laws and rates
of reactions, or the model can be developed empirically from
experimental data. If experimental data are available, the dynamic
model should be validated, and the model accuracy is characterized. This latter
information is useful for control system design and tuning. The next step in
the control system design is to devise an appropriate control strategy that
will meet the control objectives while satisfying process constraints. As
indicated in @fig-major-steps, this design activity is both an art and a science.
Process understanding and the experience and preferences of the design team are
key factors. Computer simulation of the controlled process is used to screen
alternative control strategies and to provide preliminary estimates of
appropriate controller settings. Finally, the control system hardware and
instrumentation are selected, ordered, and installed in the plant. Then the
control system is tuned in the plant using the preliminary estimates from the
design step as a starting point. Controller tuning usually involves
trial-and-error procedures.

![Major steps in control system
development.](../../../assets/images/major-steps-control-system-developement.png){#fig-major-steps}

## Introduction to process modeling

Dynamic models are crucial in the field of process dynamics and control.

- They enhance process understanding by allowing the study of transient
  behavior without disrupting the actual process. Through computer simulations,
  we can gain valuable insights into both dynamic and steady-state process
  behaviors, providing useful information even before a plant is constructed.

- Process simulators are indispensable for training plant operators to manage
  complex units and emergency situations. When connected to process control
  equipment, these simulators create a realistic training environment, much
  like flight simulators in the aviation industry. This helps operators build
  practical skills and respond effectively to challenging situations.

- A dynamic process model assists in evaluating various control strategies by
  pinpointing the variables to be controlled and manipulated. It can also help
  in preliminary controller tuning and in the application of empirical models
  before the plant's start-up. In strategies based on model control, the
  process model explicitly participates in the formulation of the control law,
  resulting in more efficient control implementation.

- Periodically recalculating optimum operating conditions can prove beneficial
  in maximizing profit or reducing costs in a process. By using a steady-state
  process model and economic data, the most profitable operating conditions can
  be identified. This approach allows for optimization and continuous
  enhancement of process performance.

## Types of process models (empirical, mechanistic, etc.)

Models can be classified as:

- Theoretical models are developed using the principles of chemistry, physics,
  and biology.
- Empirical models are obtained by fitting experimental data.
- Semi-empirical models are a combination of the models in categories (a) and
  (b); the numerical values of one or more of the parameters in a theoretical
  model are calculated from experimental data.

## Basic principles of mass and energy balances

- Theoretical models 
  
  Developed using the principles of chemistry, physics,
  and biology.

  First principles models

  Mass, momentum, and heat balances

- Empirical models 

  Obtained by fitting experimental data.

  Statistical models

  Correlations

  data driven models

- Semi-empirical/ hybrid models 

  A combination of the theoretical and empirical models

  The numerical values of one or more of the parameters in a theoretical model
  are calculated from experimental data.

![Creating a hybrid model](../../../assets/images/hybrid_models.png)

## Basic principles of mass and energy balances

- In general

  $$
  \text{accumulation} = \text{in} - \text{out} - \text{reaction} - \text{tranfer}
  $$ {#eq-gen_bal}

- Mass balance (without reaction and transfer)

  $$
  \left\{\begin{array}{c}
  \text {rate of mass} \\
  \text {accumulation}
  \end{array}\right\} 
  = \left\{\begin{array}{c}
    \text {rate of} \\
    \text {mass in}
    \end{array}\right\}
  - \left\{\begin{array}{c}
    \text {rate of} \\
    \text {mass out}
    \end{array}\right\}
  $$ {#eq-mass_bal}


- For component _i_ (with reaction term included) 

  $$
    \left\{\begin{array}{c}
    \text {rate of} \\
    \text {component i} \\
    \text {accumulation}
    \end{array}\right\} 
    = \left\{\begin{array}{c}
      \text {rate of} \\
      \text {component i} \\
      \text {in}
      \end{array}\right\}
    - \left\{\begin{array}{c}
      \text {rate of} \\
      \text {componenti } \\
      \text {out}
      \end{array}\right\}
    + \left\{\begin{array}{c}
      \text {rate of} \\
      \text {component i} \\
      \text {produced}
      \end{array}\right\}
  $$ {#eq-component_bal}

## Basic principles of mass and energy balances

- Energy balance

$$
\begin{aligned}
\left\{\begin{array}{c}
\text { rate of energy } \\
\text { accumulation }
\end{array}\right\} &= \left\{\begin{array}{c}
\text { rate of energy in } \\
\text { by convection }
\end{array}\right\} \\
& -\left\{\begin{array}{c}
\text { rate of energy out } \\
\text { by convection }
\end{array}\right\} \\
& +\left\{\begin{array}{c}
\text { net rate of heat addition } \\
\text { to the system from } \\
\text { the surroundings }
\end{array}\right\} \\
& +\left\{\begin{array}{c}
\text { net rate of work } \\
\text { performed on the system } \\
\text { by the surroundings }
\end{array}\right\}
\end{aligned}
$$ {#eq-energy_bal}

## Blending of two components

![Stirred tank blending process](../../../assets/images/blending-example.png)

- Overall mass balance 

  $$
  \left\{\begin{array}{c}
  \text {rate of accumulation} \\
  \text {of mass in the tank}
  \end{array}\right\} 
  = \left\{\begin{array}{c}
    \text {rate of} \\
    \text {mass in}
    \end{array}\right\}
  - \left\{\begin{array}{c}
    \text {rate of} \\
    \text {mass out}
    \end{array}\right\}
  $$ {#eq-blend_mass_bal_verbose}

  $$
  \frac{d(V \rho)}{dt} = w_1 + w_2 - w
  $$ {#eq-blend_mass_bal}

- Component balance

  $$
  \frac{d(V \rho x)}{dt} = w_1 x_1 + w_2 x_2 - w x
  $$ {#eq-blend_component_bal}

It is possible to further simplify the system of two differential equations to 

$$
  \frac{dV}{dt} = \frac{1}{\rho}\left(w_1 x_1 + w_2 x_2 - w x\right)
$$ {#eq-blend_1}

$$
  \frac{dx}{dt} = \frac{w_1}{V \rho} \left(x_1 - x\right)+ \frac{w_2}{V \rho} \left(x_2 - x\right)
$$ {#eq-blend_2}


## Degrees of freedom (DOF) analysis
To simulate a process, it's crucial to confirm that the model equations, both
differential and algebraic, form a set of relations that can be solved. In
simple terms, we need to ensure that the output variables (usually those on the
left side of the equations) can be determined based on the input variables
(those on the right side of the equations). For instance, consider a set of
linear algebraic equations represented as **y = Ax**. To have a unique solution
for **x**, vectors **x** and **y** need to have the same number of elements and
matrix **A** should be nonsingular, meaning it has a nonzero determinant.

For large, complex steady-state or dynamic models, evaluating such a condition
is not straightforward. However, a general requirement exists: for the model to
have a unique solution, the count of unknown variables should match the number
of independent model equations. In other words, all available degrees of
freedom must be taken into account. The number of degrees of freedom,
represented as $N_F$, can be determined using a particular expression.

$$N_F = N_V - N_E$$ {#eq-dof}

where $N_V$ is the total number of process variables (distinct from constant
process parameters) and $N_E$ is the number of independent equations.

A degrees of freedom analysis allows modeling problems to be classified
according to the following categories:

1. $N_F = 0$: 
   The process model is exactly specified. If $NF = 0$, then the number of
   equations is equal to the number of process variables and the set of
   equations has a solution. (However, the solution may not be unique for a set
   of nonlinear equations.)

2. $N_F > 0$: 
   The process is underspecified. If $N_F > 0$, then $N_V > N_E$, so there are
   more process variables than equations. Consequently, the $N_E$ equations have
   an infinite number of solutions, because NF process variables can be
   specified arbitrarily.

3. $N_F < 0$:
   The process model is overspecified. For $N_F < 0$, there are fewer process
   variables than equations, and consequently the set of equations has no
   solution.

### DOF for the blending problem

- Parameters (2): $V, \rho$
- Variables ($N_V = 4): $x, x_1, x_2, w_1, w_1$
- equation ($N_E = 1$): @eq-blend_mass_bal

The degrees of freedom are calculated as $N_F = 4 − 1 = 3$. Thus, we must
identify three input variables that can be specified as known functions of time
in order for the equation to have a unique solution. The dependent variable $x$
is an obvious choice for the output variable in this simple example.
Consequently, we have

- output (1): $x$
- inputs (3): $x_1, w_1, w_2$

Because all of the degrees of freedom have been utilized, the single equation
is exactly specified and can be solved.

## Process control terminology

## Response of first-order systems
## Response of second-order systems
## Transient and steady-state behavior of processes
## Process time constants and lags

## Linearization of process models

## Stability analysis and the concept of poles and zeros

## Frequency response analysis

## Bode plots and Nyquist plots


## Introduction to feedback control

## Proportional, integral, and derivative control actions

## PID control and tuning methods

## Stability analysis
